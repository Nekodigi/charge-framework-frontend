(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[640],{2996:function(e,t,a){Promise.resolve().then(a.bind(a,8151))},8151:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return T}});var o=a(9440),n=a(3271),r=a(4957),i=a(1007),c=a(9843),l=a(5793),s=a(5507),d=a(4240),p=a(8780),u=a(7653),h=a(6006),g=a(6008),m=a(9268),f=a(8511);function Z(e){let t=e.toUpperCase().split(" ");return{sx:{bgcolor:function(e){let t,a=0;for(t=0;t<e.length;t+=1)a=e.charCodeAt(t)+((a<<5)-a);let o="#";for(t=0;t<3;t+=1){let e=a>>8*t&255;o+="00".concat(e.toString(16)).slice(-2)}return o}(e)},children:"".concat(t[0][0]).concat(t.length>=2?t[1][0]:"")}}var b=a(4092),x=a(1771),k=a(9714),y=a(7455),w=a(122),v=a(3470),E=a(4200),S=a(3401);let C=e=>{let{user:t}=e;(0,g.useRouter)();let{service_id:a}=(0,g.useParams)(),[o,n]=(0,h.useState)(null),r=!!o,i=()=>{n(null)};return(0,m.jsxs)(x.Z,{children:[(0,m.jsx)(k.Z,{onClick:e=>{n(e.currentTarget)},"aria-controls":r?"account-menu":void 0,"aria-haspopup":"true","aria-expanded":r?"true":void 0,children:(0,m.jsx)(y.Z,{...Z(t.displayName?t.displayName:t.email)})}),(0,m.jsxs)(w.Z,{anchorEl:o,id:"account-menu",open:r,onClose:i,onClick:i,PaperProps:{elevation:0,sx:{overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))","& .MuiAvatar-root":{width:32,height:32,ml:-.5,mr:1}}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[(0,m.jsxs)(v.Z,{onClick:i,children:[(0,m.jsx)(y.Z,{...Z(t.displayName?t.displayName:t.email)})," ",t.displayName?t.displayName:t.email]}),(0,m.jsx)(E.Z,{}),(0,m.jsxs)(v.Z,{onClick:()=>{n(null),f.I8.signOut()},children:[(0,m.jsx)(S.Z,{children:(0,m.jsx)(b.Z,{fontSize:"small"})}),"Logout"]})]})]})};var j=a(4214);let F=()=>{let{user:e}=(0,u.E)(),t=(0,r.Z)();(0,g.useRouter)();let{service_id:a}=(0,g.useParams)(),m=(0,g.useSearchParams)(),[f,Z]=(0,h.useState)("");return(0,h.useEffect)(()=>{let e=async()=>{Z((await (0,j.Z)({url:"".concat("https://charge-framework-backend-o3mmnjeefa-an.a.run.app","/service/").concat(a),method:"get",data:{}})).data.name)};e()},[a]),(0,o.tZ)(i.Z,{position:"static",sx:{background:"white",borderBottom:1,borderColor:t.palette.com.gray500Op50},elevation:0,children:(0,o.tZ)(c.Z,{maxWidth:"md",style:{paddingLeft:0,paddingRight:0},children:(0,o.tZ)(l.Z,{children:(0,o.BX)(s.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",width:"100%",children:[(0,o.tZ)(d.Z,{css:(0,n.Ge)(t).title,children:f||a}),e?(0,o.tZ)(C,{user:e}):(0,o.tZ)(p.k,{type:"contained",href:"/".concat(a,"/login").concat(m.get("link_target")?"?link_target=".concat(m.get("link_target")):""),label:"Login",style:{padding:12,paddingTop:4,paddingBottom:4,height:27},labelStyle:(0,n.Ge)(t).body})]})})})})};var _=a(4066),B=a(6063),P=a(307);let D=e=>{let t=(0,r.Z)();return(0,m.jsxs)(x.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,m.jsx)(x.Z,{sx:{width:"100%",mr:1},children:(0,m.jsx)(B.Z,{variant:"determinate",value:Math.min(100,e.current/e.maximum*100),...e,sx:{height:12,borderRadius:8,["& .".concat(P.Z.bar)]:{borderRadius:5,backgroundColor:t.palette.com.green500},["&.".concat(P.Z.colorPrimary)]:{border:1,borderColor:t.palette.com.gray400,backgroundColor:"transparent"}}})}),(0,m.jsx)(x.Z,{sx:{minWidth:35},children:(0,m.jsx)(d.Z,{variant:"body2",color:"text.secondary",children:"".concat(e.current.toFixed(1),"/").concat(e.maximum.toFixed(0))})})]})};var A=a(6626),I=a(5910);let N=e=>{let{checked:t,text:a}=e,i=(0,r.Z)();return(0,o.BX)(s.Z,{direction:"row",gap:1.5,children:[t?(0,o.tZ)(A.Z,{sx:{color:i.palette.com.green500}}):(0,o.tZ)(I.Z,{sx:{color:i.palette.com.red500}}),(0,o.tZ)(d.Z,{css:(0,n.Ge)(i).item,children:a})]})},W={free:"Starter",basic:"Professional","pay-as-you-go":"Pay as you go"},X=e=>({free:e.palette.com.gray500,basic:e.palette.com.green500,"pay-as-you-go":e.palette.com.blue500}),R=e=>{let{plan:t,currentPlan:a,cancelAtPeriodEnd:i}=e,{service_id:c}=(0,g.useParams)(),{user:l}=(0,u.E)(),m=(0,r.Z)(),[f,Z]=(0,h.useState)(void 0),[b,k]=(0,h.useState)("Apply"),y=(0,g.useSearchParams)(),w=(0,h.useMemo)(()=>["pay-as-you-go"===t.id?{checked:!0,text:"Add token for this month"}:{checked:!0,text:"".concat(t.quota," Token/month")},"free"===t.id?{checked:!1,text:"Available when demand is low"}:{checked:!0,text:"No limitation by demand"}],[t]),v=(0,h.useMemo)(()=>X(m)[t.id],[t]),E=(0,h.useMemo)(()=>W[t.id],[t]),S=(0,h.useMemo)(()=>{switch(t.id){case"free":return"Free";case"basic":return"".concat(t.currency.toUpperCase()," $").concat(t.price,"/mo");case"pay-as-you-go":return"".concat(t.currency.toUpperCase()," $").concat(t.price,"/token")}},[t]);(0,h.useEffect)(()=>{switch(t.id){case"free":i?k("Plan will be downgraded"):k("Downgrade plan"),"free"===a||i||Z("".concat(c,"/subscription/cancel"));break;case"basic":"free"===a&&k("Upgrade plan"),"basic"!==a?(console.log("".concat("https://charge-framework-backend-o3mmnjeefa-an.a.run.app","/subscription/url/").concat(c,"/").concat(null==l?void 0:l.uid,"/").concat(t.id,"?success_url=").concat(window.location.href,"&cancel_url=").concat(window.location.href)),Z("".concat("https://charge-framework-backend-o3mmnjeefa-an.a.run.app","/subscription/url/").concat(c,"/").concat(null==l?void 0:l.uid,"/").concat(t.id,"?success_url=").concat(window.location.href,"&cancel_url=").concat(window.location.href))):i?Z("".concat(c,"/subscription/resume")):Z("".concat(c,"/subscription/cancel"));break;case"pay-as-you-go":k("Purchase tokens"),Z("".concat("https://charge-framework-backend-o3mmnjeefa-an.a.run.app","/payment/url/").concat(c,"/").concat(null==l?void 0:l.uid,"?quota=",500,"&success_url=").concat(window.location.href,"&cancel_url=").concat(window.location.href))}t.id===a&&("basic"===t.id&&i?k("Resume plan"):"free"===t.id&&i?k("Your plan will be downgraded"):k("You current plan"))},[t,a,i]);let C=(0,h.useMemo)(()=>{switch(t.id){case"free":if("free"===a)break;if(!i)return"pointer";break;case"basic":case"pay-as-you-go":return"pointer"}return"default"},[t,a,i]);return(0,o.tZ)(_.ZP,{item:!0,xs:12,sm:6,children:(0,o.BX)(x.Z,{borderRadius:2,overflow:"hidden",sx:{border:1,borderColor:m.palette.com.gray500},children:[(0,o.tZ)(x.Z,{sx:{backgroundColor:v,height:8}}),(0,o.BX)(s.Z,{sx:{p:2},gap:1.5,children:[(0,o.BX)(s.Z,{direction:"row",justifyContent:"space-between",alignItems:"flex-end",children:[(0,o.tZ)(d.Z,{css:(0,n.Ge)(m).title,children:E}),(0,o.tZ)(d.Z,{css:(0,n.Ge)(m).subtitle,children:S})]}),(0,o.tZ)(s.Z,{gap:1,children:w.map((e,t)=>(0,o.tZ)(N,{checked:e.checked,text:e.text},t))}),(0,o.tZ)(p.k,{type:a===t.id?"contained":"fill",color:v,href:l?f:"/".concat(c,"/login?action=subscribe&plan=").concat(t.id,"&link_target=").concat(y.get("link_target")),onClick:"free"===t.id||i?void 0:()=>{},style:{cursor:C},label:b})]})]})})};var O=a(9881),z=a(7994);let H=e=>{let t=z.W,{useLogo:a}=e;return void 0===a&&(a=!0),(0,m.jsx)(x.Z,{position:"relative",height:32,children:a?(0,m.jsxs)(O.Z,{href:"https://nekodigi.com",children:[(0,m.jsx)(x.Z,{component:"img",src:"light"===t.palette.mode?"/icons/nekodigi/light.png":"/icons/nekodigi/dark.png",width:32}),(0,m.jsx)(d.Z,{sx:{position:"absolute",left:27,top:10,fontSize:16,fontWeight:700,fontFamily:"Roboto, sans-serif",lineHeight:"19px",color:t.palette.local.black},children:"ekodigi"})]}):(0,m.jsx)(O.Z,{href:"https://nekodigi.com",children:(0,m.jsx)(d.Z,{sx:{position:"absolute",top:7,left:7,fontSize:16,fontWeight:700,fontFamily:"Roboto, sans-serif",lineHeight:"19px",color:t.palette.local.black},children:"Nekodigi"})})})};var J=a(2801),G=a(4821);let M=()=>{let e=(0,r.Z)(),t=[n.Vl.Jp,n.CH.px14,{color:e.palette.local.gray,fontWeight:500}],a=(e,a)=>(0,o.tZ)(O.Z,{href:e,underline:"none",children:(0,o.tZ)(d.Z,{css:t,children:a})});return(0,o.BX)("div",{children:[(0,o.tZ)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,o.tZ)("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:""}),(0,o.tZ)("link",{href:"https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap",rel:"stylesheet"}),(0,o.tZ)(i.Z,{position:"relative",sx:{bgcolor:e.palette.local.white},elevation:0,children:(0,o.tZ)(c.Z,{children:(0,o.BX)(l.Z,{sx:{py:2,px:2,color:e.palette.local.black,borderTop:"1px solid",borderColor:e.palette.local.whiteDark,[e.breakpoints.down("md")]:{flexDirection:"column",alignItem:"flex-start"}},children:[(0,o.BX)(s.Z,{direction:"row",gap:16,sx:{[e.breakpoints.down("sm")]:{flexDirection:"column",width:"100%"},pb:8},children:[(0,o.tZ)(s.Z,{gap:2,children:(0,o.tZ)(H,{useLogo:!0})}),(0,o.tZ)(s.Z,{direction:"row",gap:8,sx:{[e.breakpoints.down("sm")]:{flexDirection:"column"}},children:[{name:"Services",items:[{alt:"Creative Magic",url:"https://play.google.com/store/apps/details?id=com.Nekodigi.CreativeMagic"},{alt:"Web Answer Sheet",url:"https://webans.nekodigi.com/"},{alt:"Artifact Sim",url:"https://artifact.nekodigi.com/"}]},{name:"Legal",items:[{alt:"Privacy Policy",url:"https://nekodigi.com/terms/privacy"},{alt:"Act on Specified Commercial Transactions",url:"https://nekodigi.com/terms/commercial-law"}]}].map(e=>(0,o.BX)(s.Z,{gap:2,sx:{width:{xs:"100%",sm:128}},children:[(0,o.tZ)(d.Z,{css:[n.Vl.Jp,n.CH.px14,{fontWeight:700}],children:e.name}),e.items.map(e=>a(e.url,e.alt))]},e.name))})]}),(0,o.tZ)(x.Z,{flexGrow:1}),(0,o.BX)(x.Z,{sx:{display:{sm:"flex"},pb:8},gap:2,children:[(0,o.tZ)(k.Z,{href:"https://github.com/Nekodigi",children:(0,o.tZ)(J.hJX,{color:e.palette.local.black})}),(0,o.tZ)(k.Z,{href:"https://www.youtube.com/c/Nekodigi",children:(0,o.tZ)(J.V2E,{color:e.palette.local.black})}),(0,o.tZ)(k.Z,{href:"https://nekodigi.hatenablog.com/archive",children:(0,o.tZ)(G.GTW,{color:e.palette.local.black})}),(0,o.tZ)(k.Z,{href:"https://play.google.com/store/apps/dev?id=8989861170574890555",children:(0,o.tZ)(J.Wfz,{color:e.palette.local.black})})]})]})})})]})};function T(e){let{params:t}=e,a=(0,r.Z)(),{service_id:i}=t,{user:l}=(0,u.E)(),[p,g]=(0,h.useState)(!1),[m,f]=(0,h.useState)(""),[Z,b]=(0,h.useState)({}),[k,y]=(0,h.useState)(0),[w,v]=(0,h.useState)(0);return(0,h.useEffect)(()=>{let e=async()=>{let e=await (0,j.Z)({url:"".concat("https://charge-framework-backend-o3mmnjeefa-an.a.run.app","/user/").concat(i,"/").concat(null==l?void 0:l.uid),method:"get",data:{}}),t=e.data;g(t.cancel_at_period_end),f(t.plan),console.log(t),console.log(t=(e=await (0,j.Z)({url:"".concat("https://charge-framework-backend-o3mmnjeefa-an.a.run.app","/service/plan/").concat(i),method:"get",data:{}})).data),b(t.plan),console.log(t=(e=await (0,j.Z)({url:"".concat("https://charge-framework-backend-o3mmnjeefa-an.a.run.app","/quota/").concat(i,"/").concat(null==l?void 0:l.uid),method:"get",data:{}})).data),y(t.allocQuota),v(t.remainQuota)};e()},[l,i]),(0,h.useEffect)(()=>{if(0===Object.keys(Z).length||Object.keys(Z).indexOf("pay-as-you-go")>-1)return;let e={...Z.free};e.id="pay-as-you-go",Z["pay-as-you-go"]=e,b({...Z})},[Z]),(0,o.BX)(x.Z,{children:[(0,o.tZ)(F,{}),(0,o.tZ)(c.Z,{maxWidth:"md",sx:{py:4,minHeight:"100vh"},children:(0,o.BX)(s.Z,{gap:4,children:[(0,o.BX)(s.Z,{gap:1.5,children:[(0,o.tZ)(d.Z,{css:(0,n.Ge)(a).title,children:"Your Token"}),(0,o.tZ)(D,{current:w,maximum:k})]}),(0,o.tZ)(_.ZP,{container:!0,spacing:2,children:Object.keys(Z).map(e=>{let t=Z[e];return"pay-as-you-go"===e&&"free"===m?null:(0,o.tZ)(R,{plan:t,currentPlan:m,cancelAtPeriodEnd:p},e)})})]})}),(0,o.tZ)(M,{})]})}},8780:function(e,t,a){"use strict";a.d(t,{k:function(){return l}});var o=a(9440),n=a(3271),r=a(4957),i=a(5507),c=a(4240);let l=e=>{let{type:t,buttonType:a,img:l,color:s,href:d,label:p,style:u,labelStyle:h,onClick:g}=e,m=(0,r.Z)(),f={display:"flex",justifyContent:"center",alignItems:"center",height:48,borderRadius:4,textDecoration:"none",..."contained"===t?{border:2,borderStyle:"solid",borderColor:m.palette.com.black}:{backgroundColor:s},...u},Z=(0,o.BX)(i.Z,{direction:"row",gap:1.5,alignItems:"center",children:[l?(0,o.tZ)("img",{src:l,width:24,height:24}):void 0,(0,o.tZ)(c.Z,{css:[(0,n.Ge)(m).item,{fontWeight:700,color:"contained"===t?m.palette.com.black:m.palette.com.white},h],children:p})]});return d?(0,o.tZ)("a",{style:f,href:d,onClick:g,children:Z}):(0,o.tZ)("button",{type:a,style:f,onClick:g,children:Z})}},8511:function(e,t,a){"use strict";a.d(t,{Ap:function(){return l},I8:function(){return s}});var o=a(1313),n=a(4734),r=a(2040);let i={apiKey:"AIzaSyChB7eBjMaX_lRpfIgUxQDi39Qh82R4oyQ",authDomain:"sandbox-35d1d.firebaseapp.com",projectId:"sandbox-35d1d",storageBucket:"sandbox-35d1d.appspot.com",messagingSenderId:r.env.NEXT_PUBLIC_FIREBASE_MESSAGE_SENDER_ID,appId:r.env.NEXT_PUBLIC_FIREBASE_SENDER_ID},c=(0,o.ZF)(i),l=new n.hJ,s=(0,n.v0)(c)},3271:function(e,t,a){"use strict";a.d(t,{CH:function(){return r},Ge:function(){return i},Vl:function(){return n}});var o=a(2120);let n={Jp:(0,o.iv)({fontFamily:'"Roboto", "Noto Sans JP"'})},r={px32:(0,o.iv)({fontSize:32,lineHeight:"46px"}),px24:(0,o.iv)({fontSize:24,lineHeight:"29px"}),px20:(0,o.iv)({fontSize:20,lineHeight:"24px"}),px18:(0,o.iv)({fontSize:18,lineHeight:"26px"}),px16:(0,o.iv)({fontSize:16,lineHeight:"19px"}),px14:(0,o.iv)({fontSize:14,lineHeight:"20px"}),px12:(0,o.iv)({fontSize:12,lineHeight:"17px"})},i=e=>({title:(0,o.iv)([r.px20,n.Jp,{fontWeight:700,color:e.palette.text.primary}]),subtitle:(0,o.iv)([r.px16,n.Jp,{fontWeight:700,color:e.palette.text.secondary}]),item:(0,o.iv)([r.px18,n.Jp,{fontWeight:500,color:e.palette.text.primary}]),body:(0,o.iv)([r.px16,n.Jp,{fontWeight:500,color:e.palette.text.primary}]),disc:(0,o.iv)([r.px14,n.Jp,{fontWeight:500,color:e.palette.text.primary}])})},7994:function(e,t,a){"use strict";a.d(t,{W:function(){return p}});var o=a(2780),n=a(7090),r=a(8537),i=a(8238),c=a(1460);let l={white:"#FFFFFF",whiteOp70:"rgba(255, 255, 255, 0.7);",whiteOp20:"rgba(255, 255, 255, 0.2);",black:"#000000",blackOp50:"rgba(0, 0, 0, 0.5);",green500:i.Z["500"],red500:c.Z["500"],blue500:n.Z["500"],gray800:"#424242",gray500:"#9E9E9E",gray400:"#BDBDBD",gray500Op50:"rgba(158, 158, 158, 0.5);",artifactBg:"linear-gradient(117.46deg, #6D5654 0.71%, #E3AA54 101.54%);",dawn:" linear-gradient(156.05deg, #FF0000 -55.32%, #FFB199 111.96%);",main:{A100:o.Z.A100,A200:o.Z.A200,200:o.Z["200"],300:o.Z["300"],400:o.Z["400"],500:o.Z["500"],600:o.Z["600"],700:o.Z["700"],L500:n.Z["500"]},scale:{10:"#8FE646",20:"#C2E645",30:"#E6D517",40:"#E68D17",50:"#E66B45",60:"#E65370"}},s="#212121",d="#757575",p=(0,r.Z)({palette:{mode:"light",com:l,primary:o.Z,secondary:n.Z,local:{bg:"#EEEEEE",modal:"F5F5F5",paper:"#FFFFFF",white:"#FFFFFF",black:s,gray:d,nekodigi:"linear-gradient(117.75deg, #CC208E 16.15%, #6713D2 87.96%);",whiteDark:"#D1D1D1"},text:{primary:s,secondary:d}}})},7653:function(e,t,a){"use strict";a.d(t,{E:function(){return s},H:function(){return d}});var o=a(9268),n=a(8511),r=a(4214),i=a(6008),c=a(6006);let l=(0,c.createContext)({});function s(){return(0,c.useContext)(l)}function d(e){let{children:t}=e,[a,s]=(0,c.useState)(null),[d,p]=(0,c.useState)(!0),u=(0,i.useSearchParams)(),{service_id:h}=(0,i.useParams)();return(0,c.useEffect)(()=>{let e=n.I8.onAuthStateChanged(e=>{s(e),p(!1);let t=async()=>{let t=u.get("link_target");console.log("proceed?"+t),(null==e?void 0:e.uid)&&t&&(console.log("updated!"),await (0,r.Z)({url:"".concat("https://charge-framework-backend-o3mmnjeefa-an.a.run.app","/redirect/").concat(h,"/").concat(t,"?dest_user=").concat(null==e?void 0:e.uid),method:"put",data:{}}))};t()});return()=>{e()}},[]),(0,o.jsx)(l.Provider,{value:{user:a,loading:d},children:!d&&t})}}},function(e){e.O(0,[913,625,296,833,813,883,356,253,769,744],function(){return e(e.s=2996)}),_N_E=e.O()}]);